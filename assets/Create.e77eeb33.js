import{c as F,a as k,b as O,o as Q}from"./index.esm.649fd59a.js";import{M as W}from"./MyCheckbox.f2e368bd.js";import{M as i}from"./MyDateRangePicker.9bf8c213.js";import{M as Y}from"./MySelect.c814ee28.js";import{a7 as _,u as H,r as d,j as o,a,n as J,l as X,M as I,p as Z,U as ee,B}from"./index.e5d80a55.js";import{P as ae,M as se,a as re}from"./MyDivider.9f45eeca.js";import{u as G,K as p,U as h}from"./url.1178bcbf.js";import{u as te}from"./usePostQuery.56c363fc.js";import{u as oe,C as le}from"./index.esm.746166b2.js";const xe=()=>{var S,N,v,C,M;const j=_(),{t:s}=H(),[z,g]=d.exports.useState(!1),[u,x]=d.exports.useState(""),[c,$]=d.exports.useState([]),[y,f]=d.exports.useState([]),q=[{label:s("Policy Groups"),url:"#"}],{data:m}=G({key:p.getListOrganizationSelf,url:h.getListOrganizationSelf,params:{}}),{data:A}=G({key:p.getPolicyResources,url:h.getPolicyResources,params:{}}),R=(e,l)=>{f(l?r=>[...new Set([...r,e])]:r=>r.filter(n=>n!==e))},T=()=>{!u.trim()||($(e=>[...e,u.trim()]),x(""))},E=F().shape({name:k().required(),type:k().required(),organizationId:O().required()}),{handleSubmit:K,register:b,reset:L,control:U,formState:{errors:t}}=oe({defaultValues:{},mode:"onChange",resolver:Q(E)}),{mutate:V}=te({listKeyId:p.getPolicyGroups,hideSuccessToast:!0}),D=e=>{const l={...e,resourceIds:y,resources:c};V({url:h.getPolicyGroups,attributes:l},{onSuccess:()=>{B.success(s("Successfully created!")),L(),j("/policy/groups")},onError:r=>{var n,w,P;console.log(r),B.error((P=(w=(n=r==null?void 0:r.response)==null?void 0:n.data)==null?void 0:w.error)==null?void 0:P.message)}})};return o(ae,{children:[o("div",{className:"flex flex-col",children:[a("h1",{className:"headers-core dark:text-text-title-dark text-text-base",children:s("Policy groups")}),a(se,{items:q})]}),a(re,{}),o("form",{action:"",onSubmit:K(D),children:[o("div",{className:"flex justify-between",children:[o("div",{className:"flex w-1/3 flex-col gap-4",children:[a(i,{label:s("Group name"),...b("name"),error:Boolean((S=t==null?void 0:t.name)==null?void 0:S.message),helperText:s(`${(N=t==null?void 0:t.name)==null?void 0:N.message}`),placeholder:s("Group name")}),a(i,{label:s("Group type"),...b("type"),error:Boolean((v=t==null?void 0:t.type)==null?void 0:v.message),helperText:s(`${(C=t==null?void 0:t.type)==null?void 0:C.message}`),placeholder:s("Group type")}),a(le,{name:"organizationId",control:U,render:({field:e,fieldState:l})=>a(Y,{label:s("Select organization"),options:m==null?void 0:m.map(r=>({label:r.fullName,value:r.id})),value:e.value,onChange:r=>{var n;return e.onChange(Number((n=r==null?void 0:r.value)!=null?n:r))},onBlur:e.onBlur,error:!!l.error,required:!0})})]}),o("div",{className:"h-[600px] w-1/2 overflow-y-auto rounded-md border-2 border-solid border-gray-300 bg-gray-100 p-4",children:[o("div",{className:"flex items-center gap-4",children:[a(i,{startIcon:a(J,{className:"stroke-text-muted"}),placeholder:s("Search")}),a("div",{onClick:()=>g(!0),className:"font-medium w-[190px] [&_svg]:stroke-bg-white sm:px-[2px] sm:text-xs lg:px-2 lg:text-sm ",children:s("Add resources")})]}),a("div",{className:"flex flex-col gap-2 mt-8",children:(M=X.exports.get(A,"data"))==null?void 0:M.map(e=>a(W,{label:e==null?void 0:e.value,id:e.id,checked:y.includes(e.id),onChange:l=>R(e.id,l)},e.id))})]})]}),a("div",{className:"flex justify-end mt-4",children:a(I,{type:"submit",variant:"primary",children:s("Submit")})})]}),a(Z,{modalProps:{show:Boolean(z),onClose:()=>{g(!1)}},headerProps:{children:a("h2",{className:"text-xl font-semibold",children:s("Add social media")}),className:"px-6"},bodyProps:{children:o(ee,{children:[o("div",{className:"flex items-end gap-4",children:[a(i,{label:s("Social media"),className:"mt-0",value:u,onChange:e=>x(e.target.value),placeholder:s("Social media")}),a(I,{variant:"primary",className:"w-[120px]",onClick:T,children:s("Enter")})]}),a("div",{className:"flex items-center flex-wrap mt-4 gap-2",children:c==null?void 0:c.map(e=>a("div",{className:"bg-gray-200 p-1 rounded-lg cursor-pointer",children:e},e))})]}),className:"py-4"}})]})};export{xe as default};
