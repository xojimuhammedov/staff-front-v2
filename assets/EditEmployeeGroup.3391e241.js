import{M as g}from"./MyCheckbox.f2e368bd.js";import"./MyDateRangePicker.9bf8c213.js";import{r as b,u as j,ad as A,a7 as B,j as u,a,M as D,B as S}from"./index.e5d80a55.js";import{a as G}from"./MyDivider.9f45eeca.js";import{L as K}from"./LabelledCaption.19e76a03.js";import{u as Q,U as m,K as v}from"./url.1178bcbf.js";import{u as w}from"./usePostQuery.56c363fc.js";import{u as T}from"./useGetOneQuery.b7db22b1.js";import{u as U}from"./index.esm.746166b2.js";const Z=()=>{var f,y;const[i,t]=b.exports.useState([]),{t:n}=j(),{id:p}=A(),x=B(),{data:l}=T({id:p,url:m.getPolicyList,params:{},enabled:!!p}),{data:d}=Q({key:v.getEmployeeList,url:m.getEmployeeList,params:{}}),{handleSubmit:E,formState:{errors:F}}=U({defaultValues:{},mode:"onChange"}),{mutate:N}=w({listKeyId:v.employeeBulk,hideSuccessToast:!0}),k=()=>{const e={policyId:Number(p),employeeIds:i};N({url:m.employeeBulk,attributes:e},{onSuccess:()=>{S.success(n("Successfully updated!")),x("/policy")},onError:s=>{var r,o,c;console.log(s),S.error((c=(o=(r=s==null?void 0:s.response)==null?void 0:r.data)==null?void 0:o.error)==null?void 0:c.message)}})};b.exports.useEffect(()=>{var e,s,r,o;if((s=(e=l==null?void 0:l.data)==null?void 0:e.employees)!=null&&s.length){const c=(o=(r=l==null?void 0:l.data)==null?void 0:r.employees)==null?void 0:o.map(M=>M.id);t(c)}},[l==null?void 0:l.data]);const h=((f=d==null?void 0:d.data)==null?void 0:f.map(e=>e==null?void 0:e.id))||[],C=e=>{t(e?h:[])},I=(e,s)=>{t(s?r=>[...r,e]:r=>r.filter(o=>o!==e))},L=h.length>0&&i.length===h.length;return u("form",{onSubmit:E(k),children:[a(K,{title:n("Add employees to group"),subtitle:n("Short description describing this collection")}),u("div",{className:"border p-4 mt-8 rounded-lg",children:[u("div",{className:"grid grid-cols-3 w-full",children:[a("div",{className:"flex items-center gap-2",children:a(g,{checked:L,onChange:e=>C(e),label:"Employee"})}),a("div",{children:"Department"}),a("div",{children:"Phone"})]}),a(G,{}),(y=d==null?void 0:d.data)==null?void 0:y.map(e=>{var s;return u("div",{className:"grid grid-cols-3 my-6 w-full",children:[a("div",{children:a(g,{label:e==null?void 0:e.name,checked:i.includes(e==null?void 0:e.id),onChange:r=>I(e==null?void 0:e.id,r)})}),a("div",{children:(s=e==null?void 0:e.department)==null?void 0:s.shortName}),a("div",{children:e==null?void 0:e.phone})]},e==null?void 0:e.id)})]}),a("div",{className:"flex justify-end mt-4",children:a(D,{type:"submit",variant:"primary",children:n("Create")})})]})};export{Z as default};
