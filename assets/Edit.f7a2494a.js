import{M as O}from"./MyCheckbox.f2e368bd.js";import{M as Y,a as H}from"./MyDateRangePicker.9bf8c213.js";import{M as T}from"./MySelect.c814ee28.js";import{ad as J,u as X,a7 as Z,r as f,l as i,j as d,a,M as F,ac as _,B as $}from"./index.e5d80a55.js";import{P as G,M as ee,a as x}from"./MyDivider.9f45eeca.js";import{L as m}from"./LabelledCaption.19e76a03.js";import{u as C,U as g,K as y}from"./url.1178bcbf.js";import{u as ae}from"./usePutQuery.9abfc37d.js";import{u as te}from"./useGetOneQuery.b7db22b1.js";import{u as se,C as K}from"./index.esm.746166b2.js";const ge=()=>{var k,L,j,z,P,A;const{id:b}=J(),{t:r}=X(),I=Z(),Q=[{label:r("Employees"),url:"#"}],{data:s}=te({id:b,url:g.getEmployeeGroups,params:{},enabled:!!b}),{data:N}=C({key:y.getPolicyList,url:g.getPolicyList,params:{}}),{data:u}=C({key:y.getEmployeeList,url:g.getEmployeeList,params:{}}),{data:S}=C({key:y.getListOrganizationSelf,url:g.getListOrganizationSelf,params:{}}),{handleSubmit:U,register:E,control:M,reset:B,formState:{errors:n}}=se({defaultValues:f.exports.useMemo(()=>({name:i.exports.get(s,"data.name"),description:i.exports.get(s,"data.description"),organizationId:i.exports.get(s,"data.organizationId"),policyId:i.exports.get(s,"data.policyId")}),[s==null?void 0:s.data]),mode:"onChange"});f.exports.useEffect(()=>{B({name:i.exports.get(s,"data.name"),description:i.exports.get(s,"data.description"),organizationId:i.exports.get(s,"data.organizationId"),policyId:i.exports.get(s,"data.policyId")})},[s==null?void 0:s.data]);const{mutate:q}=ae({listKeyId:y.getEmployeeGroups,hideSuccessToast:!0}),[v,p]=f.exports.useState([]);f.exports.useEffect(()=>{var e,o,t,l;if((o=(e=s==null?void 0:s.data)==null?void 0:e.employees)!=null&&o.length){const c=(l=(t=s==null?void 0:s.data)==null?void 0:t.employees)==null?void 0:l.map(h=>h.id);p(c)}},[s==null?void 0:s.data]);const D=e=>{const o={employees:v,...e};q({url:`${g.getEmployeeGroups}/${b}`,attributes:o},{onSuccess:()=>{$.success(r("Successfully updated!")),B(),I("/employee-group")},onError:t=>{var l,c,h;console.log(t),$.error((h=(c=(l=t==null?void 0:t.response)==null?void 0:l.data)==null?void 0:c.error)==null?void 0:h.message)}})},w=((k=u==null?void 0:u.data)==null?void 0:k.map(e=>e==null?void 0:e.id))||[],R=e=>{p(e?w:[])},V=(e,o)=>{p(o?t=>[...t,e]:t=>t.filter(l=>l!==e))},W=w.length>0&&v.length===w.length;return d(G,{children:[d("div",{className:"flex flex-col",children:[a("h1",{className:"headers-core text-text-base dark:text-text-title-dark",children:r("Add new employee")}),a(ee,{items:Q})]}),a(x,{}),a(F,{onClick:()=>I("/employee-group"),variant:"secondary",startIcon:a(_,{}),children:r("Back to employee group list")}),a(x,{}),d("form",{className:"max-w-5xl",onSubmit:U(D),children:[d("div",{className:"mb-12 flex w-full items-start justify-between",children:[a(m,{className:"flex-1",title:r("Group name"),subtitle:r("Short and easy-to-understand name")}),a(Y,{rootClassName:"max-w-[462px]",placeholder:r("Enter group name"),...E("name"),error:Boolean((L=n==null?void 0:n.name)==null?void 0:L.message),helperText:r(`${(j=n==null?void 0:n.name)==null?void 0:j.message}`)})]}),d("div",{className:"mb-12 flex w-full items-start justify-between",children:[a(m,{className:"flex-1",title:r("Group name"),subtitle:r("Short description describing this collection")}),a(H,{rootClassName:"max-w-[462px]",placeholder:r("Enter group description"),...E("description"),error:Boolean((z=n==null?void 0:n.description)==null?void 0:z.message),helperText:r(`${(P=n==null?void 0:n.description)==null?void 0:P.message}`)})]}),d("div",{className:"mb-12 flex w-full items-start justify-between",children:[a(m,{className:"flex-1",title:r("Organization"),subtitle:r("")}),a("div",{className:"w-[462px]",children:a(K,{name:"organizationId",control:M,render:({field:e,fieldState:o})=>a(T,{options:S==null?void 0:S.map(t=>({label:t.fullName,value:t.id})),placeholder:"Select organization",value:e.value,onChange:t=>{var l;return e.onChange(Number((l=t==null?void 0:t.value)!=null?l:t))},onBlur:e.onBlur,error:!!o.error,required:!0})})})]}),d("div",{className:"mb-12 flex w-full items-start justify-between",children:[a(m,{className:"flex-1",title:r("Policy"),subtitle:r("")}),a("div",{className:"w-[462px]",children:a(K,{name:"policyId",control:M,render:({field:e,fieldState:o})=>{var t;return a(T,{options:(t=N==null?void 0:N.data)==null?void 0:t.map(l=>({label:l.title,value:l.id})),placeholder:"Select policy",value:e.value,onChange:l=>{var c;return e.onChange(Number((c=l==null?void 0:l.value)!=null?c:l))},onBlur:e.onBlur,error:!!o.error,required:!0})}})})]}),a(x,{}),a(m,{title:r("Add employees to group"),subtitle:r("Short description describing this collection")}),a(x,{}),d("div",{className:"border rounded-lg",children:[d("div",{className:"grid grid-cols-3 w-full bg-[#F9FAFB] p-4",children:[a("div",{className:"flex items-center gap-2",children:a(O,{checked:W,onChange:e=>R(e),label:"Employee"})}),a("div",{children:"Department"}),a("div",{children:"Phone"})]}),a("div",{className:"px-4",children:(A=u==null?void 0:u.data)==null?void 0:A.map(e=>{var o;return d("div",{className:"grid grid-cols-3 my-6 w-full",children:[a("div",{children:a(O,{label:e==null?void 0:e.name,checked:v.includes(e==null?void 0:e.id),onChange:t=>V(e==null?void 0:e.id,t)})}),a("div",{children:(o=e==null?void 0:e.department)==null?void 0:o.shortName}),a("div",{children:e==null?void 0:e.phone})]},e==null?void 0:e.id)})})]}),a("div",{className:"flex justify-end mt-4",children:a(F,{type:"submit",variant:"primary",children:r("Update")})})]})]})};export{ge as default};
