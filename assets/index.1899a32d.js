import{P as _,M as V,a as W}from"./MyDivider.9f45eeca.js";import{D as q,T as Y,a as Z}from"./ui.constants.4870ca8b.js";import{u as F,a,p as O,j as u,M as T,B as A,r as x,U as v,$ as H,a0 as J,a1 as X,a2 as ee,l as K,o as ae}from"./index.e5d80a55.js";import{K as b,u as P,U as y}from"./url.1178bcbf.js";import{u as se,C as te}from"./Pagination.4bfa72ff.js";import{c as re,a as E,b as ne,o as le}from"./index.esm.649fd59a.js";import{M as $}from"./MyDateRangePicker.9bf8c213.js";import{M as D}from"./MySelect.c814ee28.js";import{u as Q}from"./usePostQuery.56c363fc.js";import{u as G,C as R,g as h}from"./index.esm.746166b2.js";import{u as oe}from"./usePutQuery.9abfc37d.js";import{u as ie}from"./useGetOneQuery.b7db22b1.js";import"./MyCheckbox.f2e368bd.js";import"./key-type.enum.09acb669.js";import"./helper.f810761f.js";const me=({refetch:l,open:S,setOpen:g})=>{var z,U,B,I,L,k;const{t:o}=F(),{mutate:i}=Q({listKeyId:b.getListUsersManagment,hideSuccessToast:!0}),{data:f}=P({key:b.getListOrganizationSelf,url:y.getListOrganizationSelf,params:{}}),{data:c}=P({key:b.getUserRoles,url:y.getUserRoles}),m=re().shape({name:E().required(),username:E().required(),password:E().required(),role:E().required(),organizationId:ne()}),{handleSubmit:w,register:N,reset:M,control:C,formState:{errors:r}}=G({defaultValues:{},mode:"onChange",resolver:le(m)}),n=d=>{i({url:y.getListUsersManagment,attributes:d},{onSuccess:()=>{A.success(o("Successfully created!")),M(),l(),g(!1)},onError:e=>{var s,t,p;console.log(e),A.error((p=(t=(s=e==null?void 0:e.response)==null?void 0:s.data)==null?void 0:t.error)==null?void 0:p.message)}})};return a(O,{modalProps:{show:Boolean(S),onClose:()=>{g(!1)}},headerProps:{children:a("h2",{className:"text-xl font-semibold",children:o("Add a user")}),className:"px-6"},bodyProps:{children:u("form",{onSubmit:w(n),className:"flex flex-wrap gap-3",action:"",children:[u("div",{className:"grid grid-cols-2 gap-4 w-full",children:[a($,{...N("name"),error:Boolean((z=r==null?void 0:r.name)==null?void 0:z.message),helperText:o(`${(U=r==null?void 0:r.name)==null?void 0:U.message}`),label:o("Full Name")}),a($,{...N("username"),error:Boolean((B=r==null?void 0:r.username)==null?void 0:B.message),helperText:o(`${(I=r==null?void 0:r.username)==null?void 0:I.message}`),label:o("Username")}),a($,{...N("password"),error:Boolean((L=r==null?void 0:r.password)==null?void 0:L.message),helperText:o(`${(k=r==null?void 0:r.password)==null?void 0:k.message}`),label:o("Password")}),a(R,{name:"role",control:C,render:({field:d,fieldState:e})=>a(D,{label:o("Select role"),options:c==null?void 0:c.map(s=>({label:s,value:s})),value:d.value,onChange:s=>{var t;return d.onChange((t=s==null?void 0:s.value)!=null?t:s)},onBlur:d.onBlur,error:!!e.error})}),a(R,{name:"organizationId",control:C,render:({field:d,fieldState:e})=>a(D,{label:o("Select organization"),options:f==null?void 0:f.map(s=>({label:s.fullName,value:s.id})),value:d.value,onChange:s=>{var t;return d.onChange(Number((t=s==null?void 0:s.value)!=null?t:s))},onBlur:d.onBlur,error:!!e.error})})]}),u("div",{className:"mb-[5px] flex w-full justify-end gap-4",children:[u(T,{type:"submit",variant:"primary",children:[" ",o("Add & Save permit")]}),u(T,{className:"w-[98px]",onClick:()=>{g(!1)},variant:"secondary",children:[" ",o("Close")]})]})]}),className:"px-[20px]"}})},de=({refetch:l,open:S,setOpen:g,userId:o})=>{var U,B,I,L,k,d;const{t:i}=F();Q({listKeyId:b.getListUsersManagment,hideSuccessToast:!0});const{data:f}=P({key:b.getListOrganizationSelf,url:y.getListOrganizationSelf,params:{}}),{data:c}=P({key:b.getUserRoles,url:y.getUserRoles}),{data:m}=ie({id:o,url:y.getListUsersManagment,params:{},enabled:!!o}),{mutate:w}=oe({listKeyId:b.getListUsersManagment,hideSuccessToast:!0}),{handleSubmit:N,register:M,reset:C,control:r,formState:{errors:n}}=G({defaultValues:x.exports.useMemo(()=>({name:h(m,"data.name"),username:h(m,"data.username"),password:h(m,"data.password"),role:h(m,"data.role"),organizationId:h(m,"data.organizationId")}),[m]),mode:"onChange"});x.exports.useEffect(()=>{C({name:h(m,"data.name"),username:h(m,"data.username"),password:h(m,"data.password"),role:h(m,"data.role"),organizationId:h(m,"data.organizationId")})},[m]);const z=e=>{w({url:`${y.getListUsersManagment}/${o}`,attributes:e},{onSuccess:()=>{A.success(i("Successfully created!")),C(),l(),g(!1)},onError:s=>{var t,p,j;console.log(s),A.error((j=(p=(t=s==null?void 0:s.response)==null?void 0:t.data)==null?void 0:p.error)==null?void 0:j.message)}})};return a(O,{modalProps:{show:Boolean(S),onClose:()=>{g(!1)}},headerProps:{children:a("h2",{className:"text-xl font-semibold",children:i("Add a user")}),className:"px-6"},bodyProps:{children:u("form",{onSubmit:N(z),className:"flex flex-wrap gap-3",action:"",children:[u("div",{className:"grid grid-cols-2 gap-4 w-full",children:[a($,{...M("name"),error:Boolean((U=n==null?void 0:n.name)==null?void 0:U.message),helperText:i(`${(B=n==null?void 0:n.name)==null?void 0:B.message}`),label:i("Full Name")}),a($,{...M("username"),error:Boolean((I=n==null?void 0:n.username)==null?void 0:I.message),helperText:i(`${(L=n==null?void 0:n.username)==null?void 0:L.message}`),label:i("Username")}),a($,{...M("password"),error:Boolean((k=n==null?void 0:n.password)==null?void 0:k.message),helperText:i(`${(d=n==null?void 0:n.password)==null?void 0:d.message}`),label:i("Password")}),a(R,{name:"role",control:r,render:({field:e,fieldState:s})=>a(D,{label:i("Select role"),options:c==null?void 0:c.map(t=>({label:t,value:t})),value:e.value,onChange:t=>{var p;return e.onChange((p=t==null?void 0:t.value)!=null?p:t)},onBlur:e.onBlur,error:!!s.error})}),a(R,{name:"organizationId",control:r,render:({field:e,fieldState:s})=>a(D,{label:i("Select organization"),options:f==null?void 0:f.map(t=>({label:t.fullName,value:t.id})),value:e.value,onChange:t=>{var p;return e.onChange(Number((p=t==null?void 0:t.value)!=null?p:t))},onBlur:e.onBlur,error:!!s.error})})]}),u("div",{className:"mb-[5px] flex w-full justify-end gap-4",children:[u(T,{type:"submit",variant:"primary",children:[" ",i("Add & Save permit")]}),u(T,{className:"w-[98px]",onClick:()=>{g(!1)},variant:"secondary",children:[" ",i("Close")]})]})]}),className:"px-[20px]"}})},ue=()=>{const{t:l}=F(),[S,g]=x.exports.useState(!1),[o,i]=x.exports.useState(!1),[f,c]=x.exports.useState(!1),[m,w]=x.exports.useState(null),[N,M]=x.exports.useState(null),{data:C,isLoading:r,refetch:n}=P({key:b.getListUsersManagment,url:y.getListUsersManagment,params:{}}),{mutate:z}=se({listKeyId:b.getListUsersManagment}),U=x.exports.useMemo(()=>[{key:"name",label:l("Employees"),headerClassName:"w-1/3",cellRender:e=>a("div",{className:"flex items-center gap-4 dark:text-text-title-dark",children:e==null?void 0:e.name})},{key:"username",label:l("Username"),headerClassName:"w-1/3",cellRender:e=>{var s;return a(v,{children:(s=e==null?void 0:e.username)!=null?s:"--"})}},{key:"role",label:l("Role"),headerClassName:"w-1/3",cellRender:e=>{var s;return a(v,{children:(s=e==null?void 0:e.role)!=null?s:"--"})}}],[l]),B=[{id:1,label:l("Name"),headerClassName:"w-1/3"},{id:2,label:l("Username"),headerClassName:"w-1/3"},{id:3,label:l("Role"),headerClassName:"w-1/3"}],I=e=>{c(!0),w(e)},L=e=>{i(!0),M(e)},k=x.exports.useMemo(()=>[{icon:a(H,{size:q}),type:"primary",name:l("Deactive"),action:(e,s)=>{}},{icon:a(J,{size:q}),type:"primary",name:l("Edit"),action:(e,s)=>{L(e==null?void 0:e.id)}},{icon:a(X,{color:"red",size:q}),type:"danger",name:l("Delete"),action:(e,s)=>{I(e==null?void 0:e.id)}}],[l]),d=()=>{z({url:`${y.getListUsersManagment}/${m}`},{onSuccess:()=>{n(),c(!1)}})};return r?a("div",{className:"absolute flex h-full w-full items-center justify-center",children:a(ee,{})}):u(v,{children:[a(Y,{values:{columns:U,filter:[],rows:K.exports.get(C,"data",[]),keyExtractor:"id"},children:a(Z,{isLoading:r,hasAction:!1,hasCustomizeColumns:!0,hasFilters:!1,dataColumn:B,hasExport:!1,hasCheckbox:!1,rowActions:k,pagination:K.exports.get(C,"meta"),hasButton:a(v,{children:a(T,{onClick:()=>{g(!0)},startIcon:a(ae,{}),variant:"primary",className:"[&_svg]:stroke-bg-white w-[150px] text-sm",children:l("Add a user")})})})}),a(me,{refetch:n,open:S,setOpen:g}),a(de,{refetch:n,setOpen:i,open:o,userId:N}),a(te,{title:l("Ushbu foydalanuvchini o'chirmoqchimisiz?"),subTitle:l("Bu amalni qaytarib bo'lmaydi!"),open:f,setOpen:c,confirmationDelete:d})]})},ce=()=>{const{t:l}=F(),S=[{label:l("Users"),url:"#"}];return u(_,{children:[u("div",{className:"flex flex-col",children:[a("h1",{className:"headers-core dark:text-text-title-dark text-text-base",children:l("Users")}),a(V,{items:S})]}),a(W,{}),a(ue,{})]})},ke=ce;export{ke as default};
