import{P as W,M as Y,a as H}from"./MyDivider.9f45eeca.js";import{u as V,a as e,j as i,l as d,M as N,B as j,r as w,i as J,P as X,k as Z,N as ee,c as ae,S as te,T as se,n as le,o as ne,p as G}from"./index.e5d80a55.js";import{u as q,K as C,U as y}from"./url.1178bcbf.js";import{u as re,M as oe,C as ie}from"./Pagination.4bfa72ff.js";import{u as de}from"./useGetOneQuery.b7db22b1.js";import{M as u}from"./MyDateRangePicker.9bf8c213.js";import{M as K}from"./MySelect.c814ee28.js";import{u as U,C as Q}from"./index.esm.746166b2.js";import{c as me,a as k,b as R,o as ce}from"./index.esm.649fd59a.js";import{u as pe}from"./usePostQuery.56c363fc.js";import{u as ue}from"./usePutQuery.9abfc37d.js";import{M as he}from"./MyBadge.4a72dd55.js";const ge=({refetch:s,onClose:D})=>{var v,B,I,M,_,$,z,A,L,T,E,F;const{t:a}=V(),{data:f}=q({key:C.getListOrganizationSelf,url:y.getListOrganizationSelf,params:{}}),n=me().shape({fullName:k().required(),shortName:k().required(),email:k(),address:k(),additionalDetails:k(),phone:k(),organizationId:R().required(),parentId:R()}),{handleSubmit:x,register:p,reset:b,control:h,watch:S,formState:{errors:t}}=U({defaultValues:{phone:void 0},mode:"onChange",resolver:ce(n)}),{mutate:l}=pe({listKeyId:C.getAllListDepartment,hideSuccessToast:!0}),P=m=>{l({url:y.getAllListDepartment,attributes:m},{onSuccess:()=>{j.success(a("Successfully created!")),b(),s(),D()},onError:c=>{var r,o,g;console.log(c),j.error((g=(o=(r=c==null?void 0:c.response)==null?void 0:r.data)==null?void 0:o.error)==null?void 0:g.message)}})},{data:O}=q({key:C.getAllListDepartment,url:y.getAllListDepartment,params:{organizationId:S("organizationId")}});return e("div",{className:"p-4",children:i("form",{onSubmit:x(P),action:"",children:[i("div",{className:"grid grid-cols-2 gap-4",children:[e(u,{...p("fullName"),error:Boolean((v=t==null?void 0:t.fullName)==null?void 0:v.message),helperText:a(`${(B=t==null?void 0:t.fullName)==null?void 0:B.message}`),label:a("Department full name")}),e(u,{...p("shortName"),error:Boolean((I=t==null?void 0:t.shortName)==null?void 0:I.message),helperText:a(`${(M=t==null?void 0:t.shortName)==null?void 0:M.message}`),label:a("Department short name")}),e(u,{...p("email"),error:Boolean((_=t==null?void 0:t.email)==null?void 0:_.message),helperText:a(`${($=t==null?void 0:t.email)==null?void 0:$.message}`),label:a("Department email"),type:"email"}),e(u,{...p("address"),error:Boolean((z=t==null?void 0:t.address)==null?void 0:z.message),helperText:a(`${(A=t==null?void 0:t.address)==null?void 0:A.message}`),label:a("Department address")}),e(u,{...p("additionalDetails"),error:Boolean((L=t==null?void 0:t.additionalDetails)==null?void 0:L.message),helperText:a(`${(T=t==null?void 0:t.additionalDetails)==null?void 0:T.message}`),label:a("Department details")}),e(u,{...p("phone"),error:Boolean((E=t==null?void 0:t.phone)==null?void 0:E.message),helperText:a(`${(F=t==null?void 0:t.phone)==null?void 0:F.message}`),type:"tel",placeholder:"+998 (_ _)  _ _ _  _ _  _ _",label:a("Phone number")}),e(Q,{name:"organizationId",control:h,render:({field:m,fieldState:c})=>e(K,{label:a("Select organization"),options:f==null?void 0:f.map(r=>({label:r.fullName,value:r.id})),value:m.value,onChange:r=>{var o;return m.onChange(Number((o=r==null?void 0:r.value)!=null?o:r))},onBlur:m.onBlur,error:!!c.error,required:!0})}),e(Q,{name:"parentId",control:h,render:({field:m,fieldState:c})=>{var r;return e(K,{label:a("Select department"),options:(r=d.exports.get(O,"data"))==null?void 0:r.map(o=>({label:o.fullName,value:o.id})),value:m.value,onChange:o=>{var g;return m.onChange(Number((g=o==null?void 0:o.value)!=null?g:o))},onBlur:m.onBlur,error:!!c.error})}})]}),i("div",{className:"mt-2 flex w-full justify-end gap-4",children:[e(N,{type:"submit",variant:"primary",children:a("Submit")}),i(N,{onClick:()=>{D(),b()},variant:"secondary",children:[" ",a("Close")]})]})]})})},xe=({onClose:s,refetch:D,data:a,departmentId:f})=>{var v,B,I,M,_,$,z,A,L,T,E,F;const{t:n}=V(),{data:x}=q({key:C.getListOrganizationSelf,url:y.getListOrganizationSelf,params:{}}),{data:p}=q({key:C.getAllListDepartment,url:y.getAllListDepartment,params:{}}),{handleSubmit:b,register:h,reset:S,control:t,formState:{errors:l}}=U({defaultValues:w.exports.useMemo(()=>({fullName:d.exports.get(a,"data.fullName"),shortName:d.exports.get(a,"data.shortName"),email:d.exports.get(a,"data.email"),address:d.exports.get(a,"data.address"),additionalDetails:d.exports.get(a,"data.additionalDetails"),phone:d.exports.get(a,"data.phone"),organizationId:d.exports.get(a,"data.organizationId"),parentId:d.exports.get(a,"data.parentId")}),[a]),mode:"onChange"});w.exports.useEffect(()=>{S({fullName:d.exports.get(a,"data.fullName"),shortName:d.exports.get(a,"data.shortName"),email:d.exports.get(a,"data.email"),address:d.exports.get(a,"data.address"),additionalDetails:d.exports.get(a,"data.additionalDetails"),phone:d.exports.get(a,"data.phone"),organizationId:d.exports.get(a,"data.organizationId"),parentId:d.exports.get(a,"data.parentId")})},[a]);const{mutate:P}=ue({listKeyId:C.getAllListOrganization,hideSuccessToast:!0});return e("div",{className:"p-4",children:i("form",{onSubmit:b(m=>{P({url:`${y.getAllListDepartment}/${f}`,attributes:m},{onSuccess:()=>{j.success(n("Edit successfully!")),S(),D(),s()},onError:c=>{var r,o,g;console.log(c),j.error((g=(o=(r=c==null?void 0:c.response)==null?void 0:r.data)==null?void 0:o.error)==null?void 0:g.message)}})}),action:"",children:[i("div",{className:"grid grid-cols-2 gap-4",children:[e(u,{...h("fullName"),error:Boolean((v=l==null?void 0:l.fullName)==null?void 0:v.message),helperText:n(`${(B=l==null?void 0:l.fullName)==null?void 0:B.message}`),label:n("Department full name")}),e(u,{...h("shortName"),error:Boolean((I=l==null?void 0:l.shortName)==null?void 0:I.message),helperText:n(`${(M=l==null?void 0:l.shortName)==null?void 0:M.message}`),label:n("Department short name")}),e(u,{...h("email"),error:Boolean((_=l==null?void 0:l.email)==null?void 0:_.message),helperText:n(`${($=l==null?void 0:l.email)==null?void 0:$.message}`),label:n("Department email"),type:"email"}),e(u,{...h("address"),error:Boolean((z=l==null?void 0:l.address)==null?void 0:z.message),helperText:n(`${(A=l==null?void 0:l.address)==null?void 0:A.message}`),label:n("Department address")}),e(u,{...h("additionalDetails"),error:Boolean((L=l==null?void 0:l.additionalDetails)==null?void 0:L.message),helperText:n(`${(T=l==null?void 0:l.additionalDetails)==null?void 0:T.message}`),label:n("Department details")}),e(u,{...h("phone"),error:Boolean((E=l==null?void 0:l.phone)==null?void 0:E.message),helperText:n(`${(F=l==null?void 0:l.phone)==null?void 0:F.message}`),type:"tel",placeholder:"+998 (_ _)  _ _ _  _ _  _ _",label:n("Phone number")}),e(Q,{name:"organizationId",control:t,render:({field:m,fieldState:c})=>e(K,{label:n("Select organization"),options:x==null?void 0:x.map(r=>({label:r.fullName,value:r.id})),value:m.value,onChange:r=>{var o;return m.onChange(Number((o=r==null?void 0:r.value)!=null?o:r))},onBlur:m.onBlur,error:!!c.error,required:!0})}),e(Q,{name:"parentId",control:t,render:({field:m,fieldState:c})=>{var r;return e(K,{label:n("Select department"),options:(r=d.exports.get(p,"data"))==null?void 0:r.map(o=>({label:o.fullName,value:o.id})),value:m.value,onChange:o=>{var g;return m.onChange(Number((g=o==null?void 0:o.value)!=null?g:o))},onBlur:m.onBlur,error:!!c.error})}})]}),i("div",{className:"mt-2 flex w-full justify-end gap-4",children:[e(N,{type:"submit",variant:"primary",children:n("Submit")}),i(N,{onClick:()=>{s(),S()},variant:"secondary",children:[" ",n("Close")]})]})]})})},fe=({item:s,setOpen:D,setDepartmentId:a,setShow:f})=>{var x,p;const{t:n}=V();return i("div",{className:"bg-white border border-gray-200 rounded-lg shadow-sm p-4 gap-2",children:[i("div",{className:"flex items-center justify-between",children:[e("h3",{className:"text-xl font-inter font-medium dark:text-text-title-dark",children:s==null?void 0:s.fullName}),e(he,{variant:"green",children:n("Active")})]}),i("div",{className:"grid grid-cols-2 gap-2 my-4",children:[i("div",{className:"rounded-lg bg-[#F9FAFB] p-3",children:[e("h5",{className:"text-sm",children:n("Departments")}),e("h3",{className:"text-2xl font-inter font-bold dark:text-text-title-dark",children:(x=s==null?void 0:s._count)==null?void 0:x.children})]}),i("div",{className:"rounded-lg bg-[#F9FAFB] p-3",children:[e("h5",{className:"text-sm",children:n("Employees")}),e("h3",{className:"text-2xl font-inter font-bold dark:text-text-title-dark",children:(p=s==null?void 0:s._count)==null?void 0:p.employees})]})]}),i("div",{className:"flex items-center gap-2",children:[e(J,{width:"16px"}),e("p",{children:s==null?void 0:s.address})]}),i("div",{className:"flex items-center gap-2 mt-2",children:[e(X,{width:"16px"}),e("p",{children:s==null?void 0:s.phone})]}),i("div",{className:"flex items-center gap-2 mt-2",children:[e(Z,{width:"16px"}),e("p",{children:s==null?void 0:s.email})]}),i("div",{className:"flex items-center gap-2 mt-2",children:[e(ee,{width:"16px"}),e("p",{children:s==null?void 0:s.additionalDetails})]}),i("div",{className:"flex items-center justify-between mt-4",children:[e(N,{variant:"secondary",className:"w-[170px]",startIcon:e(ae,{}),children:n("View")}),e(N,{variant:"secondary",className:"w-[170px]",onClick:()=>{f(!0),a(s==null?void 0:s.id)},startIcon:e(te,{}),children:n("Edit")}),e(N,{onClick:()=>{D(!0),a(s==null?void 0:s.id)},variant:"secondary",startIcon:e(se,{color:"red"})})]})]})},be=()=>{var B;const{t:s}=V(),[D,a]=w.exports.useState(!1),[f,n]=w.exports.useState(!1),[x,p]=w.exports.useState(!1),[b,h]=w.exports.useState(null),{data:S,refetch:t}=q({key:C.getAllListDepartment,url:y.getAllListDepartment,params:{}}),l=[{label:s("Department"),url:"#"}],{mutate:P}=re({listKeyId:C.getAllListDepartment}),O=()=>{P({url:`${y.getAllListDepartment}/${b}`},{onSuccess:()=>{t(),n(!1)}})},{data:v}=de({id:b,url:y.getAllListDepartment,params:{},enabled:!!b});return i(W,{paginationProps:e(oe,{total:d.exports.get(S,"total")}),children:[i("div",{className:"flex flex-col",children:[e("h1",{className:"headers-core dark:text-text-title-dark text-text-base",children:s("Department")}),e(Y,{items:l})]}),e(H,{}),i("div",{className:"flex items-center justify-between",children:[e(u,{startIcon:e(le,{className:"stroke-text-muted"}),className:"w-[300px] dark:bg-bg-input-dark",placeholder:s("Search...")}),i("div",{className:"flex items-center gap-4",children:[e(N,{startIcon:e(ne,{}),onClick:()=>a(!0),variant:"primary",className:"[&_svg]:stroke-bg-white text-sm w-[200px] dark:text-text-base",children:s("Add Organization")}),e(N,{variant:"secondary",children:s("Filters")})]})]}),e("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 mt-4",children:(B=d.exports.get(S,"data"))==null?void 0:B.map(I=>e(fe,{setDepartmentId:h,setShow:p,setOpen:n,item:I}))}),e(G,{modalProps:{show:Boolean(D),onClose:()=>{a(!1)}},headerProps:{children:e("h2",{className:"text-xl font-semibold",children:s("Create new department")}),className:"px-6"},bodyProps:{children:e(ge,{refetch:t,onClose:()=>a(!1)})}}),e(ie,{title:s("Bu tashkilotni o'chirmoqchimisiz?"),subTitle:s("Bu amalni qaytarib bo'lmaydi!"),open:f,setOpen:n,confirmationDelete:O}),e(G,{modalProps:{show:Boolean(x),onClose:()=>{p(!1)}},headerProps:{children:e("h2",{className:"text-xl font-semibold",children:s("Edit department")}),className:"px-6"},bodyProps:{children:e(xe,{departmentId:b,data:v,refetch:t,onClose:()=>p(!1)})}})]})},_e=be;export{_e as default};
